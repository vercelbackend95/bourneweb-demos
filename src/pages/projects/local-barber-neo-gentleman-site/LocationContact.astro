---
const {
  id = "location",
  title = "Find us",
  subtitle = "Central spot. Easy parking. Walk in like you own the place.",

  // Demo placeholders — podmień na dane klienta
  shopName = "Neo Gentleman",
  addressLines = ["123 Example Street", "Bournemouth, BH1 1AA"],
  phone = "+447785744005",
  whatsapp = "+447785744005",
  email = "hello@yourdomain.co.uk",

  // Google Maps embed uses query — no API key needed
  mapQuery = "Bournemouth BH1 1AA",
  parking = "Paid street parking nearby · 2–4 min walk",
  transport = "Bus stop around the corner · Train 10 min",
} = Astro.props;

import phoneSvg from "./assets/phone.svg?raw";
import whatsappSvg from "./assets/whatsapp-icon.svg?raw";

const cleanWhatsApp = String(whatsapp).replace(/[^\d]/g, "");
const mapsSrc =
  `https://www.google.com/maps?q=${encodeURIComponent(mapQuery)}&output=embed`;

/** Phone: force white via currentColor (TopNav-style) */
const phoneIcon = phoneSvg
  .replace(/\s(width|height)="[^"]*"/g, "")
  .replace(/stroke="#000000"/g, 'stroke="currentColor"')
  .replace(/stroke="#0F1729"/g, 'stroke="currentColor"')
  .replace(/stroke="#292D32"/g, 'stroke="currentColor"')
  .replace(/stroke-width="2"/g, 'stroke-width="1.8"')
  .replace("<svg", '<svg width="18" height="18"');

/** WhatsApp: keep original colors, but make gradient id UNIQUE to avoid collisions */
const waIconLoc = whatsappSvg
  .replace(/\s(width|height)="[^"]*"/g, "")
  .replace(/id="paint0_linear_87_7264"/g, 'id="wa_loc_grad"')
  .replace(/url\(#paint0_linear_87_7264\)/g, "url(#wa_loc_grad)")
  .replace("<svg", '<svg width="18" height="18"');
---

<section class="bm-loc" id={id} aria-label="Location and contact">
  <div class="bm-loc__inner">
    <header class="bm-loc__head">
      <div>
        <p class="bm-loc__kicker">LOCATION</p>
        <h2 class="bm-loc__title">{title}</h2>
        <p class="bm-loc__sub">{subtitle}</p>
      </div>

      <div class="bm-loc__cta">
        <a class="bm-locBtn bm-locBtn--primary" href={`tel:${phone}`} aria-label="Call the shop">
          <span class="bm-locBtn__ico" aria-hidden="true" set:html={phoneIcon}></span>
          Call
          <span class="bm-locBtn__shine" aria-hidden="true"></span>
        </a>

        <a class="bm-locBtn" href={`https://wa.me/${cleanWhatsApp}`} target="_blank" rel="noopener" aria-label="WhatsApp the shop">
          <span class="bm-locBtn__ico" aria-hidden="true" set:html={waIconLoc}></span>
          WhatsApp
        </a>
      </div>
    </header>

    <div class="bm-loc__grid">
      <div class="bm-locMap" aria-label="Map">
        <div class="bm-locMap__frame">
          <iframe
            title={`${shopName} map`}
            src={mapsSrc}
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
            allowfullscreen
          ></iframe>
        </div>
        <div class="bm-locMap__hint">
          Tap to open Maps · Easy route
        </div>
      </div>

      <aside class="bm-locCard" aria-label="Contact details">
        <div class="bm-locCard__top">
          <div class="bm-locBadge">Walk-ins welcome · 10am–8pm</div>
          <div class="bm-locCard__h">{shopName}</div>
          <div class="bm-locCard__addr">
            {addressLines.map((l) => <div>{l}</div>)}
          </div>
        </div>

        <div class="bm-locMeta">
          <div class="bm-locMeta__row">
            <div class="bm-locMeta__k">Parking</div>
            <div class="bm-locMeta__v">{parking}</div>
          </div>
          <div class="bm-locMeta__row">
            <div class="bm-locMeta__k">Transport</div>
            <div class="bm-locMeta__v">{transport}</div>
          </div>
          <div class="bm-locMeta__row">
            <div class="bm-locMeta__k">Email</div>
            <div class="bm-locMeta__v">
              <a class="bm-locLink" href={`mailto:${email}`}>{email}</a>
            </div>
          </div>
        </div>

        <div class="bm-locCard__actions">
          <a class="bm-locMini" href={`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(mapQuery)}`} target="_blank" rel="noopener">
            Directions →
          </a>
          <a class="bm-locMini" href={`mailto:${email}?subject=${encodeURIComponent("Booking enquiry")}`}>
            Email us →
          </a>
        </div>
      </aside>
    </div>
  </div>
</section>
